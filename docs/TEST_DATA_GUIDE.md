# 🧪 테스트 데이터 가이드 (Test Data Guide)

**Version:** 1.0  
**마이그레이션 파일:** `V7__insert_test_data.sql`  
**작성일:** 2026-01-19

---

## 📋 목차

1. [개요](#1-개요)
2. [데이터 구조](#2-데이터-구조)
3. [사용자 시나리오](#3-사용자-시나리오)
4. [데이터 상세 설명](#4-데이터-상세-설명)
5. [테스트 시나리오 예시](#5-테스트-시나리오-예시)
6. [주의사항](#6-주의사항)

---

## 1. 개요

### 1.1 목적

본 테스트 데이터는 **통합 시나리오 테스트** 및 **개발 환경에서의 기능 검증**을 위해 제공됩니다.

### 1.2 포함 데이터

- ✅ **사용자 (Users)**: 20명 (10명 핵심 시나리오 + 10명 추가 더미)
- ✅ **지갑 (Wallet)**: 각 사용자마다 초기 자산 설정
- ✅ **포트폴리오 (Portfolio)**: 일부 사용자의 보유 종목
- ✅ **거래 로그 (Trade Logs)**: 매수/매도 거래 내역
- ✅ **아이템 마스터 (Items)**: 가챠/상점용 아이템 8종
- ✅ **인벤토리 (Inventory)**: 일부 사용자의 보유 아이템
- ✅ **관심종목 (Watchlist)**: 사용자별 관심 종목 리스트
- ✅ **주식 캔들 (Stock Candles)**: 주요 종목의 캔들 차트 데이터
- ✅ **채팅 히스토리 (Chat History)**: AI 도사 채팅 샘플

### 1.3 사용 환경

- ✅ **개발 환경**: 로컬 개발 및 통합 테스트
- ✅ **테스트 환경**: QA 및 시나리오 검증
- ❌ **운영 환경**: 절대 사용 금지

---

## 2. 데이터 구조

### 2.1 전체 데이터 통계

| 테이블 | 레코드 수 | 설명 |
|--------|----------|------|
| `users` | 20 | 사용자 계정 (LOCAL/GOOGLE/KAKAO) |
| `wallet` | 20 | 각 사용자 지갑 (초기 자산) |
| `portfolio` | 9 | 보유 종목 (4명의 사용자) |
| `trade_logs` | 7 | 거래 내역 (매수/매도) |
| `items` | 8 | 아이템 마스터 (NAMEPLATE/AVATAR/THEME) |
| `inventory` | 12 | 보유 아이템 (2명의 사용자) |
| `watchlist` | 14 | 관심종목 (4명의 사용자) |
| `stock_candles` | 6 | 캔들 데이터 (6개 종목) |
| `chat_history` | 1 | 채팅 세션 (1명의 사용자) |

---

## 3. 사용자 시나리오

### 3.1 핵심 사용자 (10명)

#### A. 로컬 사용자 (LOCAL)

| Email | 닉네임 | 프로필 완성도 | 랭킹 참여 | 공개 여부 |
|-------|--------|--------------|----------|----------|
| `local_user1@example.com` | LocalUser1 | ✅ 완료 | ✅ | ✅ |
| `local_user2@example.com` | LocalUser2 | ✅ 완료 | ✅ | ✅ |
| `local_user3@example.com` | LocalUser3 | ❌ 미완료 | ✅ | ✅ |
| `local_user4@example.com` | LocalUser4 | ❌ 미완료 | ❌ | ✅ |
| `local_user5@example.com` | LocalUser5 | ❌ 미완료 | ✅ | ❌ |

**특징:**
- `local_user1`: **완전한 프로필** + 포트폴리오 보유 + 관심종목 등록
- `local_user2`: 완전한 프로필 (사주: WATER, 띠: 소)
- `local_user3~5`: 온보딩 미완료 사용자 (다양한 설정 조합)

#### B. 소셜 로그인 사용자

| Email | 닉네임 | Provider | 프로필 완성도 |
|-------|--------|----------|--------------|
| `google_user1@example.com` | GUser1 | GOOGLE | ✅ 완료 |
| `google_user2@example.com` | GUser2 | GOOGLE | ✅ 완료 |
| `kakao_user1@example.com` | KUser1 | KAKAO | ✅ 완료 |
| `kakao_user2@example.com` | KUser2 | KAKAO | ✅ 완료 |

**특징:**
- `google_user1`: 포트폴리오 보유 (GOOGL, NVDA)
- `kakao_user1`: 포트폴리오 보유 (TSLA)

#### C. 데모 사용자 (Demo User)

| Email | 닉네임 | 특징 |
|-------|--------|------|
| `demo_user@example.com` | DemoUser | **가장 완전한 데이터** |

**특징:**
- ✅ 완전한 프로필 (사주: WATER, 띠: 돼지, 성별: OTHER)
- ✅ 높은 초기 자산 (20,000원)
- ✅ 다중 포트폴리오 (AAPL, MSFT, GOOGL, NVDA)
- ✅ 거래 내역 (매수/매도 포함)
- ✅ 인벤토리 보유 (6개 아이템, 일부 장착)
- ✅ 관심종목 (5개 종목)
- ✅ 채팅 히스토리

### 3.2 추가 더미 사용자 (10명)

| Email | 닉네임 | 특징 |
|-------|--------|------|
| `extra_user1@example.com` ~ `extra_user10@example.com` | ExtraUser1~10 | 최소 프로필만 설정 |

**특징:**
- 기본 지갑만 생성 (10,000원, 게임 코인 100)
- 프로필 미완료 (온보딩 필요)
- 포트폴리오/거래 내역 없음

---

## 4. 데이터 상세 설명

### 4.1 아이템 마스터 (Items)

**총 8개 아이템** (카테고리별 분류)

#### NAMEPLATE (이름표) - 3개

| 이름 | 희귀도 | 확률 | 설명 |
|------|--------|------|------|
| Basic Nameplate | COMMON | 0.5 | 기본 이름표 테두리 |
| Silver Nameplate | RARE | 0.3 | 실버 등급 이름표 |
| Golden Nameplate | EPIC | 0.15 | 골드 등급 이름표 |

#### AVATAR (아바타) - 3개

| 이름 | 희귀도 | 확률 | 설명 |
|------|--------|------|------|
| Default Avatar | COMMON | 0.4 | 기본 아바타 외형 |
| Trader Avatar | RARE | 0.25 | 트레이더 스타일 아바타 |
| Wizard Avatar | EPIC | 0.1 | 도사 스타일 아바타 |

#### THEME (테마) - 2개

| 이름 | 희귀도 | 확률 | 설명 |
|------|--------|------|------|
| Light Theme | COMMON | 0.35 | 라이트 테마 |
| Dark Theme | RARE | 0.15 | 다크 테마 |

**확률 합계:** 2.15 (가챠 확률 비율로 사용, 합 1.0 권장)

---

### 4.2 지갑 (Wallet)

**초기 자산 분포:**

| 사용자 | 예수금 | 실현 손익 | 총 자산 | 게임 코인 |
|--------|--------|----------|---------|----------|
| `local_user1` | 15,000원 | 0원 | 10,000원 | 100 |
| `local_user2` | 8,000원 | 0원 | 10,000원 | 100 |
| `google_user1` | 12,000원 | 0원 | 10,000원 | 100 |
| `google_user2` | 9,500원 | 0원 | 10,000원 | 100 |
| `kakao_user1` | 11,000원 | 0원 | 10,000원 | 100 |
| `kakao_user2` | 13,000원 | 0원 | 10,000원 | 100 |
| `demo_user` | **20,000원** | 0원 | **22,000원** | **500** |
| 기타 사용자 | 10,000원 | 0원 | 10,000원 | 100 |

**특징:**
- 기본 초기 자산: 10,000원 (예수금)
- `demo_user`는 높은 자산으로 설정 (테스트 편의성)
- 실현 손익은 모두 0원 (매도 거래 없음 또는 손익 없음)

---

### 4.3 포트폴리오 (Portfolio)

**보유 종목 현황:**

| 사용자 | 종목 | 수량 | 평균 단가 | 평가 금액 (예상) |
|--------|------|------|----------|-----------------|
| `local_user1` | AAPL | 10주 | 180.00원 | 1,951.20원 |
| `local_user1` | MSFT | 5주 | 320.00원 | 1,660.50원 |
| `google_user1` | GOOGL | 4주 | 140.00원 | 564.80원 |
| `google_user1` | NVDA | 3주 | 900.00원 | 2,731.50원 |
| `kakao_user1` | TSLA | 6주 | 220.00원 | 1,351.80원 |
| `demo_user` | AAPL | 15주 | 175.00원 | 2,926.80원 |
| `demo_user` | MSFT | 10주 | 315.00원 | 3,321.00원 |
| `demo_user` | GOOGL | 8주 | 135.00원 | 1,129.60원 |
| `demo_user` | NVDA | 5주 | 880.00원 | 4,552.50원 |

**총 평가 금액 (예상):**
- `local_user1`: 약 3,611.70원
- `google_user1`: 약 3,296.30원
- `kakao_user1`: 약 1,351.80원
- `demo_user`: 약 11,929.90원

---

### 4.4 거래 로그 (Trade Logs)

**거래 내역:**

| 사용자 | 종목 | 거래 타입 | 가격 | 수량 | 실현 손익 | 거래 일시 |
|--------|------|----------|------|------|----------|----------|
| `local_user1` | AAPL | BUY | 180.00 | 10 | - | 2026-01-10 10:00 |
| `local_user1` | MSFT | BUY | 320.00 | 5 | - | 2026-01-11 11:00 |
| `google_user1` | GOOGL | BUY | 140.00 | 4 | - | 2026-01-12 09:30 |
| `kakao_user1` | TSLA | BUY | 220.00 | 6 | - | 2026-01-13 14:15 |
| `demo_user` | AAPL | BUY | 175.00 | 15 | - | 2026-01-10 10:30 |
| `demo_user` | AAPL | **SELL** | 195.00 | 5 | **100.00** | 2026-01-15 15:00 |
| `demo_user` | NVDA | BUY | 880.00 | 5 | - | 2026-01-16 16:00 |

**특징:**
- 대부분 매수 거래 (BUY)
- `demo_user`만 매도 거래 (SELL) 포함 → 실현 손익 100원
- 거래 수수료는 모두 0원 (향후 확장)

---

### 4.5 인벤토리 (Inventory)

**보유 아이템:**

| 사용자 | 아이템 | 장착 여부 |
|--------|--------|----------|
| `demo_user` | Basic Nameplate | ❌ |
| `demo_user` | Silver Nameplate | ❌ |
| `demo_user` | **Golden Nameplate** | ✅ |
| `demo_user` | Default Avatar | ❌ |
| `demo_user` | Trader Avatar | ❌ |
| `demo_user` | Dark Theme | ❌ |
| `local_user1` | Basic Nameplate | ❌ |
| `local_user1` | Silver Nameplate | ❌ |
| `local_user1` | **Golden Nameplate** | ✅ |
| `local_user1` | Default Avatar | ❌ |
| `local_user1` | Trader Avatar | ❌ |
| `local_user1` | Dark Theme | ❌ |

**특징:**
- `demo_user`와 `local_user1`만 인벤토리 보유
- 각 사용자마다 6개 아이템 보유
- Golden Nameplate가 장착 상태 (EPIC 등급)

---

### 4.6 관심종목 (Watchlist)

**관심종목 리스트:**

| 사용자 | 관심종목 (개수) | 종목 목록 |
|--------|----------------|----------|
| `local_user1` | 5개 | AAPL, MSFT, GOOGL, AMZN, NVDA |
| `demo_user` | 5개 | AAPL, MSFT, GOOGL, AMZN, NVDA |
| `google_user1` | 2개 | AAPL, TSLA |
| `kakao_user1` | 1개 | NVDA |
| `kakao_user2` | 1개 | GOOGL |

**특징:**
- 기본 관심종목: **AAPL, MSFT, GOOGL, AMZN, NVDA** (회원가입 시 자동 추가)
- `local_user1`과 `demo_user`는 기본 5개 종목 모두 보유
- 일부 사용자는 추가로 다른 종목 관심 등록

---

### 4.7 주식 캔들 (Stock Candles)

**캔들 데이터:**

| 종목 | 날짜 | 시가 | 고가 | 저가 | 종가 | 거래량 |
|------|------|------|------|------|------|--------|
| AAPL | 2026-01-15 | 190.00 | 196.00 | 189.50 | 195.12 | 120,000,000 |
| AAPL | 2026-01-16 | 195.12 | 198.00 | 194.00 | 197.50 | 110,000,000 |
| MSFT | 2026-01-15 | 330.00 | 335.00 | 328.00 | 332.10 | 80,000,000 |
| GOOGL | 2026-01-15 | 140.00 | 142.50 | 139.00 | 141.20 | 60,000,000 |
| NVDA | 2026-01-15 | 900.00 | 920.00 | 895.00 | 910.50 | 50,000,000 |
| TSLA | 2026-01-15 | 220.00 | 228.00 | 218.00 | 225.30 | 70,000,000 |

**특징:**
- 주요 종목 6개 (AAPL, MSFT, GOOGL, NVDA, TSLA)
- AAPL만 2일치 데이터 (차트 테스트용)
- 나머지는 1일치 데이터

---

### 4.8 채팅 히스토리 (Chat History)

**채팅 세션:**

| 사용자 | 세션 ID | 메시지 수 | 감정 점수 |
|--------|---------|----------|----------|
| `demo_user` | UUID | 2개 | 0.8 |

**메시지 내용:**
```json
[
  {
    "role": "user",
    "content": "오늘 포트폴리오 어떻게 보나요?"
  },
  {
    "role": "assistant",
    "content": "현재 수익률은 약 5%이며, 기술주 비중이 높습니다."
  }
]
```

---

## 5. 테스트 시나리오 예시

### 5.1 로그인/인증 테스트

**시나리오 1: 로컬 로그인**
- Email: `local_user1@example.com`
- Password: `$2a$10$abcdefghijklmnopqrstuv` (해시된 비밀번호)
- 예상 결과: 로그인 성공, 프로필 완전, 포트폴리오/관심종목 조회 가능

**시나리오 2: 소셜 로그인 (Google)**
- Email: `google_user1@example.com`
- Provider: GOOGLE
- 예상 결과: OAuth2 인증 후 로그인, 포트폴리오 보유

**시나리오 3: 온보딩 미완료 사용자**
- Email: `local_user3@example.com`
- 예상 결과: 온보딩 페이지로 리다이렉트

---

### 5.2 거래 테스트

**시나리오 1: 매수 주문**
- 사용자: `local_user1` (예수금: 15,000원)
- 종목: AAPL
- 수량: 5주
- 예상 결과: 주문 성공, 포트폴리오 업데이트, 예수금 차감

**시나리오 2: 매도 주문**
- 사용자: `demo_user` (AAPL 15주 보유)
- 종목: AAPL
- 수량: 3주
- 예상 결과: 주문 성공, 실현 손익 계산, 예수금 증가

**시나리오 3: 잔고 부족**
- 사용자: `local_user2` (예수금: 8,000원)
- 종목: NVDA
- 수량: 10주 (약 9,000원 필요)
- 예상 결과: `TRADE_INSUFFICIENT_BALANCE` 에러

---

### 5.3 가챠/인벤토리 테스트

**시나리오 1: 가챠 뽑기**
- 사용자: `demo_user` (게임 코인: 500)
- 비용: 100 코인
- 예상 결과: 아이템 획득, 인벤토리 추가, 코인 차감

**시나리오 2: 아이템 장착**
- 사용자: `demo_user`
- 아이템: Trader Avatar (현재 미장착)
- 예상 결과: 장착 성공, 기존 장착 아이템 자동 해제

**시나리오 3: 코인 부족**
- 사용자: `local_user1` (게임 코인: 50)
- 예상 결과: `GAME_001` 에러 (코인 부족)

---

### 5.4 랭킹 테스트

**시나리오: 랭킹 조회**
- 조건: `is_ranking_joined = true` 사용자만 표시
- 예상 결과:
  - `demo_user` (총 자산: 22,000원) → 1위
  - `local_user1` (총 자산: 약 13,611원) → 2위
  - `google_user1` (총 자산: 약 13,296원) → 3위
  - `local_user4`는 랭킹 미참여로 제외

---

### 5.5 관심종목 테스트

**시나리오 1: 관심종목 조회**
- 사용자: `local_user1`
- 예상 결과: 5개 종목 반환 (AAPL, MSFT, GOOGL, AMZN, NVDA)

**시나리오 2: 관심종목 추가**
- 사용자: `local_user1`
- 종목: TSLA
- 예상 결과: 추가 성공, 총 6개 종목

**시나리오 3: 관심종목 삭제**
- 사용자: `demo_user`
- 종목: AMZN
- 예상 결과: 삭제 성공, 총 4개 종목

---

## 6. 주의사항

### 6.1 운영 환경 사용 금지

⚠️ **본 테스트 데이터는 운영 환경에서 절대 사용하지 마세요.**

- 하드코딩된 비밀번호 해시
- 예측 가능한 이메일 주소
- 테스트용 더미 데이터

### 6.2 데이터 일관성

- **외래 키 제약**: 모든 데이터는 외래 키 제약을 준수합니다.
- **고유 제약**: 이메일, 관심종목 (user_id + ticker) 등은 중복되지 않습니다.
- **NOT NULL 제약**: 필수 필드는 모두 값이 채워져 있습니다.

### 6.3 데이터 업데이트

- 테스트 중 데이터가 변경될 수 있습니다.
- 필요 시 마이그레이션을 재실행하여 초기 상태로 복구하세요.

### 6.4 확장 가능성

- 새로운 테스트 시나리오 추가 시, 기존 데이터와 충돌하지 않도록 주의하세요.
- 사용자 ID는 자동 증가하므로, 새로운 사용자 추가 시 ID 충돌 없음

---

## 7. 참고 자료

- **마이그레이션 파일**: `src/main/resources/db/migration/V7__insert_test_data.sql`
- **아이템 가이드**: `docs/ITEM_GACHA_SEEDING_GUIDE.md`
- **전체 명세서**: `docs/FULL_SPECIFICATION.md`

---

**문서 버전:** 1.0  
**최종 업데이트:** 2026-01-19
